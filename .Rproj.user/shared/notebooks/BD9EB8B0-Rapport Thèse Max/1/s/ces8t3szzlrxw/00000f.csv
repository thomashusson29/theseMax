"0","library(ggplot2)"
"0","library(ggpattern)"
"0","library(dplyr)"
"0",""
"0","# Palettes"
"0","palette_ressenti <- c("
"0","  ""Délai ok"" = ""#7ED957"","
"0","  ""Plutôt bien mais parfois gêné"" = ""#FFC94A"","
"0","  ""Délai trop long, en difficulté"" = ""#FF6B6B"","
"0","  ""Autre"" = ""grey70"""
"0",")"
"0",""
"0","palette_perte <- c("
"0","  ""non, pas du tout"" = ""#6BD6FF"","
"0","  ""Plutôt non"" = ""#A5E887"","
"0","  ""Plutôt oui"" = ""#FFD966"","
"0","  ""oui, tout à fait"" = ""#FF6B6B"""
"0",")"
"0",""
"0","# 1) Ressenti du délai"
"0","df_pct1 <- df %>%"
"0","  group_by(ressenti4) %>%"
"0","  summarise("
"0","    pct_iso = 100 * mean(`4_Profession_isolee` == 1, na.rm = TRUE),"
"0","    n = n()"
"0","  )"
"0",""
"0","ggplot(df, aes(x = ressenti4, fill = ressenti4, pattern = iso)) +"
"0","  geom_bar_pattern("
"0","    color = ""black"", width = 0.8,"
"0","    pattern_fill = ""black"", pattern_angle = 45,"
"0","    pattern_density = 0.1, pattern_spacing = 0.02,"
"0","    pattern_key_scale_factor = 0.4"
"0","  ) +"
"0","  scale_fill_manual(values = palette_ressenti) +"
"0","  scale_pattern_manual(values = c(""Non isolé"" = ""stripe"", ""Isolé"" = ""none"")) +"
"0","  geom_text("
"0","    data = df_pct1,"
"0","    aes(x = ressenti4, y = n, label = paste0(round(pct_iso, 1), ""%"")),"
"0","    vjust = -0.3, size = 4, inherit.aes = FALSE"
"0","  ) +"
"0","  labs(x = ""Ressenti du délai du SMUR"", y = ""Nombre de médecins"", pattern = ""Profession"") +"
"0","  theme_minimal(base_size = 13) +"
"0","  theme("
"0","    axis.text.x = element_text(angle = 25, hjust = 1),"
"0","    legend.position = ""top"","
"0","    legend.title = element_blank()"
"0","  ) +"
"0","  guides(fill = ""none"")"
