age <- df$`3_Age_inf_50a`
sexe <- df$`2_Sexe_Homme`
profession_isolee <- df$`4_Profession_isolee`
duree_installation <- df$`6_Duree_d_installation_inf_10ans`
activite_autre <- df$`7_Activite_autre_que_liberal_exclusif`
ressenti_delai <- df$`9_Ressenti_delai_SMUR_genee_YN`
perte_chance <- df$`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur_binaire`
CJP <- df$CJP
cols_to_include2 <- c(
"9_Ressenti_delai_SMUR",
"10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur"
)
#Ordonner les facteurs pour lisibilité
df <- df %>%
mutate(`9_Ressenti_delai_SMUR` = factor(`9_Ressenti_delai_SMUR`,
levels = c("Délai ok",
"Plutôt bien mais parfois gêné",
"Délai trop long, en difficulté",
"Autre")))
df <- df %>%
mutate(`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur` = factor(`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`,
levels = c("non, pas du tout","Plutôt non","Plutôt oui","oui, tout à fait")))
table2 <- df %>%
tbl_summary(
include = all_of(cols_to_include2), # colonnes à inclure
statistic = list(
all_categorical() ~ "{n} ({p}%)" # n (%) pour les variables catégorielles
),
label = list(
`9_Ressenti_delai_SMUR` = "Ressenti sur le délai d'intervention du SMUR",
`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur` = "Perte de chance dans votre secteur liée au délai d'intervention"
),
missing = "no" # ne pas inclure les valeurs manquantes dans le tableau
) %>%
modify_header(label = "**Caractéristiques**") %>% # modifier l'en-tête de la colonne des labels
bold_labels() # mettre en gras les labels des variables
table2
# Palette de couleurs cohérente
palette_ressenti <- c(
"Délai ok" = "#7ED957",                      # vert clair
"Plutôt bien mais parfois gêné" = "#FFC94A", # orange doux
"Délai trop long, en difficulté" = "#FF6B6B",# rouge
"Autre" = "grey70"                           # gris neutre
)
# Calcul des pourcentages avec ordre défini, en excluant les NA
df_plot <- df %>%
filter(!is.na(`9_Ressenti_delai_SMUR`)) %>%
count(`9_Ressenti_delai_SMUR`) %>%
mutate(
pct = 100 * n / sum(n),
`9_Ressenti_delai_SMUR` = factor(
`9_Ressenti_delai_SMUR`,
levels = c(
"Délai ok",
"Plutôt bien mais parfois gêné",
"Délai trop long, en difficulté",
"Autre"
)
)
)
# Graphique final dans l'ordre voulu
ggplot(df_plot, aes(x = `9_Ressenti_delai_SMUR`, y = pct, fill = `9_Ressenti_delai_SMUR`)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(round(pct, 1), "%")), vjust = -0.5, size = 4) +
scale_fill_manual(values = palette_ressenti, guide = "none") +
labs(
title = "Ressenti des médecins sur le délai d'intervention du SMUR (excluant les NA)",
x = "Ressenti du délai",
y = "Pourcentage de médecins"
) +
theme_minimal(base_size = 13) +
theme(
axis.text.x = element_text(angle = 25, hjust = 1)
)
# Palette de couleurs du bleu (non) au rouge (oui)
palette_perte_chance <- c(
"non, pas du tout" = "#6BD6FF",
"Plutôt non" = "#A5E887",
"Plutôt oui" = "#FFD966",
"oui, tout à fait" = "#FF6B6B"
)
# Calcul des pourcentages + ordre + suppression des NA
df_plot <- df %>%
filter(!is.na(`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`)) %>%
count(`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`) %>%
mutate(
pct = 100 * n / sum(n),
`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur` = factor(
`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`,
levels = c("non, pas du tout", "Plutôt non", "Plutôt oui", "oui, tout à fait")
)
)
# Graphique
ggplot(
df_plot,
aes(x = `10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`,
y = pct,
fill = `10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`)
) +
geom_col(color = "black") +
geom_text(aes(label = paste0(round(pct, 1), "%")), vjust = -0.5, size = 4) +
scale_fill_manual(values = palette_perte_chance, guide = "none") +
labs(
title = "Perte de chance perçue par les médecins liée au délai d'intervention du SMUR (excluant les NA)",
x = "Perte de chance perçue",
y = "Pourcentage de médecins"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
# Palette de couleurs du bleu (non) au rouge (oui)
palette_perte_chance <- c(
"non, pas du tout" = "#6BD6FF",
"Plutôt non" = "#A5E887",
"Plutôt oui" = "#FFD966",
"oui, tout à fait" = "#FF6B6B"
)
# Calcul des pourcentages + ordre + suppression des NA
df_plot <- df %>%
filter(!is.na(`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`)) %>%
count(`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`) %>%
mutate(
pct = 100 * n / sum(n),
`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur` = factor(
`10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`,
levels = c("non, pas du tout", "Plutôt non", "Plutôt oui", "oui, tout à fait")
)
)
# Graphique
ggplot(
df_plot,
aes(x = `10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`,
y = pct,
fill = `10_Delai_d_intervention_:_perte_de_chance_dans_votre_secteur`)
) +
geom_col(color = "black") +
geom_text(aes(label = paste0(round(pct, 1), "%")), vjust = -0.5, size = 4) +
scale_fill_manual(values = palette_perte_chance, guide = "none") +
labs(
title = "Perte de chance perçue par les médecins liée au délai d'intervention du SMUR (excluant les NA)",
x = "Perte de chance perçue",
y = "Pourcentage de médecins"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
# Palette personnalisée
palette_formation <- c(
"<2 ans" = "#6BD6FF",   # bleu clair
"2-5 ans" = "#4A90E2",  # bleu moyen
"6-10 ans" = "#0033CC", # bleu foncé
">10 ans" = "#001F66"   # bleu très foncé
)
# Diagramme en barres empilées avec la palette
ggplot(df %>% filter(!is.na(`3_Age`) & !is.na(`12_Dernieres_formations_d_urgence`)),
aes(x = `3_Age`, fill = `12_Dernieres_formations_d_urgence`)) +
geom_bar(position = "fill", color = "black") +
scale_fill_manual(values = palette_formation) +  # ✅ intégration de la palette
scale_y_continuous(labels = scales::percent_format()) +
labs(
title = "Répartition du délai depuis la dernière formation aux soins d'urgence selon l'âge des médecins",
x = "Tranche d'âge",
y = "Proportion de médecins",
fill = "Délai depuis la dernière formation"
) +
theme_minimal(base_size = 13) +
theme(
axis.text.x = element_text(angle = 25, hjust = 1),
legend.position = "right",
legend.text = element_text(size = 8),
legend.title = element_text(size = 8)
)
df$`3_Age`
unique(df$`3_Age`)
# Palette de bleus pour les délais
palette_formation <- c(
"<2 ans" = "#6BD6FF",   # bleu clair
"2-5 ans" = "#4A90E2",  # bleu moyen
"6-10 ans" = "#0033CC", # bleu foncé
">10 ans" = "#001F66"   # bleu très foncé
)
# Diagramme en barres empilées avec ordre des niveaux
ggplot(
df %>%
filter(!is.na(`3_Age`) & !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(`12_Dernieres_formations_d_urgence` = factor(
`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans")
)),
aes(x = `3_Age`, fill = `12_Dernieres_formations_d_urgence`)
) +
geom_bar(position = "fill", color = "black") +
scale_fill_manual(values = palette_formation) +
scale_y_continuous(labels = scales::percent_format()) +
labs(
title = "Répartition du délai depuis la dernière formation aux soins d'urgence selon l'âge des médecins",
x = "Tranche d'âge",
y = "Proportion de médecins",
fill = "Délai depuis la dernière formation"
) +
theme_minimal(base_size = 13) +
theme(
axis.text.x = element_text(angle = 25, hjust = 1),
legend.position = "right",
legend.text = element_text(size = 8),
legend.title = element_text(size = 8)
)s
# Palette de bleus pour les délais
palette_formation <- c(
"<2 ans" = "#6BD6FF",   # bleu clair
"2-5 ans" = "#4A90E2",  # bleu moyen
"6-10 ans" = "#0033CC", # bleu foncé
">10 ans" = "#001F66"   # bleu très foncé
)
# Diagramme en barres empilées avec ordre des niveaux
ggplot(
df %>%
filter(!is.na(`3_Age`) & !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(`12_Dernieres_formations_d_urgence` = factor(
`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans")
)),
aes(x = `3_Age`, fill = `12_Dernieres_formations_d_urgence`)
) +
geom_bar(position = "fill", color = "black") +
scale_fill_manual(values = palette_formation) +
scale_y_continuous(labels = scales::percent_format()) +
labs(
title = "Répartition du délai depuis la dernière formation aux soins d'urgence selon l'âge des médecins",
x = "Tranche d'âge",
y = "Proportion de médecins",
fill = "Délai depuis la dernière formation"
) +
theme_minimal(base_size = 13) +
theme(
axis.text.x = element_text(angle = 25, hjust = 1),
legend.position = "right",
legend.text = element_text(size = 8),
legend.title = element_text(size = 8)
)
ggplot(
df %>%
filter(!is.na(`3_Age`) & !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(`12_Dernieres_formations_d_urgence` = factor(
`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans")
)),
aes(x = `3_Age`, fill = `12_Dernieres_formations_d_urgence`)
) +
geom_bar(position = position_dodge(width = 0.8), color = "black") +
scale_fill_manual(values = palette_formation) +
labs(
title = "Délai depuis la dernière formation selon la tranche d'âge",
x = "Tranche d'âge",
y = "Nombre de médecins",
fill = "Délai depuis la dernière formation"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
df %>%
count(`3_Age`, `12_Dernieres_formations_d_urgence`) %>%
group_by(`3_Age`) %>%
mutate(pct = 100 * n / sum(n)) %>%
ggplot(aes(x = pct, y = `3_Age`, fill = `12_Dernieres_formations_d_urgence`)) +
geom_bar(stat = "identity", position = "fill", color = "white") +
scale_fill_manual(values = palette_formation) +
labs(
title = "Proportion de médecins selon le délai depuis la dernière formation",
x = "Proportion de médecins",
y = "Tranche d'âge",
fill = "Délai depuis la dernière formation"
) +
scale_x_continuous(labels = scales::percent_format()) +
theme_minimal(base_size = 13)
library(ggmosaic)
install.packages("ggmosaic")
library(ggmosaic)
ggplot(
df %>%
filter(!is.na(`3_Age`), !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
),
aes(x = product(`3_Age`, `12_Dernieres_formations_d_urgence`),
fill = `12_Dernieres_formations_d_urgence`)
) +
geom_mosaic(color = "grey30") +
scale_fill_manual(values = palette_formation) +
labs(
title = "Mosaic plot : âge vs délai de formation",
x = "Tranche d'âge", y = "",
fill = "Délai de formation"
) +
theme_minimal(base_size = 13)
rlang::last_trace()
rlang::last_trace(drop = FALSE)
df %>%
filter(!is.na(`3_Age`), !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
) %>%
ggplot(aes(x = `3_Age`, fill = `12_Dernieres_formations_d_urgence`)) +
geom_bar(position = "fill", color = "black") +
scale_fill_manual(values = palette_formation) +
scale_y_continuous(labels = scales::percent_format()) +
labs(
title = "Répartition du délai depuis la dernière formation selon l'âge",
x = "Tranche d'âge", y = "Proportion (%)",
fill = "Délai depuis la dernière formation"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
ggplot(
df %>%
filter(!is.na(`3_Age`), !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
),
aes(x = `3_Age`, fill = `12_Dernieres_formations_d_urgence`)
) +
geom_bar(position = position_dodge(width = 0.8), color = "black") +
scale_fill_manual(values = palette_formation) +
labs(
title = "Nombre de médecins par tranche d'âge et ancienneté de formation",
x = "Tranche d'âge", y = "Effectif",
fill = "Délai depuis la dernière formation"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
ggplot(
df %>%
filter(!is.na(`3_Age`), !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
),
aes(x = `3_Age`, fill = `12_Dernieres_formations_d_urgence`)
) +
geom_bar(position = position_dodge(width = 0.8), color = "black") +
scale_fill_manual(values = palette_formation) +
labs(
title = "Nombre de médecins par tranche d'âge et ancienneté de formation",
x = "Tranche d'âge", y = "Effectif",
fill = "Délai depuis la dernière formation"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
df %>%
count(`3_Age`, `12_Dernieres_formations_d_urgence`) %>%
group_by(`3_Age`) %>%
mutate(pct = 100 * n / sum(n)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
) %>%
ggplot(aes(x = `3_Age`, y = `12_Dernieres_formations_d_urgence`, fill = pct)) +
geom_tile(color = "white") +
geom_text(aes(label = paste0(round(pct), "%")), color = "white", size = 4) +
scale_fill_gradient(low = "#D6EAF8", high = "#0033CC") +
labs(
title = "Proportion de médecins selon l'âge et le délai de formation (%)",
x = "Tranche d'âge", y = "Délai depuis la dernière formation",
fill = "%"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
df %>%
count(`3_Age`, `12_Dernieres_formations_d_urgence`) %>%
group_by(`3_Age`) %>%
mutate(pct = 100 * n / sum(n)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
) %>%
ggplot(aes(x = `3_Age`, y = pct,
color = `12_Dernieres_formations_d_urgence`,
group = `12_Dernieres_formations_d_urgence`)) +
geom_line(linewidth = 1) +
geom_point(size = 3) +
scale_color_manual(values = palette_formation) +
labs(
title = "Tendance du délai depuis la dernière formation selon l'âge",
x = "Tranche d'âge", y = "Proportion (%)",
color = "Délai de formation"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
library(ggmosaic)
ggplot(
df %>%
filter(!is.na(`3_Age`), !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
)
) +
geom_mosaic(
aes(x = product(`3_Age`, `12_Dernieres_formations_d_urgence`),
fill = `12_Dernieres_formations_d_urgence`),
color = "grey30"
) +
scale_fill_manual(values = palette_formation) +
labs(
title = "Mosaic plot : âge vs délai de formation",
x = "Tranche d'âge", y = "",
fill = "Délai de formation"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
library(ggmosaic)
ggplot(
df %>%
filter(!is.na(`3_Age`), !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
)
) +
geom_mosaic(
aes(x = product(`3_Age`, `12_Dernieres_formations_d_urgence`),
fill = `12_Dernieres_formations_d_urgence`),
color = "grey30"
) +
scale_fill_manual(values = palette_formation) +
labs(
title = "Mosaic plot : âge vs délai de formation",
x = "Tranche d'âge", y = "",
fill = "Délai de formation"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
library(ggmosaic)
ggplot(
df %>%
filter(!is.na(`3_Age`), !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
)
) +
geom_mosaic(
aes(x = product(`3_Age`, `12_Dernieres_formations_d_urgence`),
fill = `12_Dernieres_formations_d_urgence`),
color = "grey30"
) +
scale_fill_manual(values = palette_formation) +
labs(
title = "Mosaic plot : âge vs délai depuis la dernière formation",
fill = "Délai de formation"
) +
theme_minimal(base_size = 13) +
theme(
axis.text.x = element_text(angle = 25, hjust = 1),
axis.title.x = element_blank(),  # ✅ masque le titre X pour éviter l'erreur
axis.title.y = element_blank()
)
library(ggmosaic)
ggplot(
df %>%
filter(!is.na(`3_Age`), !is.na(`12_Dernieres_formations_d_urgence`)) %>%
mutate(
`3_Age` = factor(`3_Age`,
levels = c("Entre 30 et 39 ans", "Entre 40 et 49 ans",
"Entre 50 et 59 ans", "Entre 60 et 69 ans", "Plus de 70 ans")),
`12_Dernieres_formations_d_urgence` = factor(`12_Dernieres_formations_d_urgence`,
levels = c("<2 ans", "2-5 ans", "6-10 ans", ">10 ans"))
)
) +
geom_mosaic(
aes(x = product(`3_Age`, `12_Dernieres_formations_d_urgence`),
fill = `12_Dernieres_formations_d_urgence`),
color = "grey30"
) +
scale_fill_manual(values = palette_formation) +
labs(
title = "Mosaic plot : âge vs délai depuis la dernière formation",
fill = "Délai de formation"
) +
theme_minimal(base_size = 13) +
theme(
axis.text.x = element_text(angle = 25, hjust = 1),
axis.title.x = element_blank(),  # ✅ masque le titre X pour éviter l'erreur
axis.title.y = element_blank()
)
